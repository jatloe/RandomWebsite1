<!DOCTYPE html>
<html>

<head>
    <link rel="icon" href="jatloesmile-hd.png">
    <title>Log Idle</title>
    <style>
        .side {
            display: inline;
        }

        body {
            font-family: 'Monospace Typewriter', monospace;
            font-size: 15px;
        }
	    
	button {
    	    font-family: 'Monospace Typewriter', monospace;
            font-size: 15px;
	}
    </style>
</head>

<body>
    <p>V1.27</p>
	<br>
	<button type="button" onclick="openTab(1)" id="tabButton1" class="side">log</button>
	<button type="button" onclick="openTab(2)" id="tabButton2" class="side" style="display:none">wlog</button>
	<div id="tab1">
		<h3 id="logs" style="font-size:18px;">You have 10 logs.</h3>
		<br><br>
		<p class="side" id="tree1Display">Maple Trees: 0</p>
		<button type="button" onclick="buyTree(1)" id="tree1" class="side">Buy Maple Tree, cost: 10.000</button>
		<button type="button" onclick="auto(1)" id="auto1" class="side" style="display:none">Auto: Off</button>
		<br>
		<p class="side" id="tree2Display">Oak Trees: 0</p>
		<button type="button" onclick="buyTree(2)" id="tree2" class="side">Buy Oak Tree, cost: 1000.000</button>
		<button type="button" onclick="auto(2)" id="auto2" class="side" style="display:none">Auto: Off</button>
		<br>
		<p class="side" id="tree3Display">Palm Trees: 0</p>
		<button type="button" onclick="buyTree(3)" id="tree3" class="side">Buy Palm Tree, cost: 100000.000</button>
		<button type="button" onclick="auto(3)" id="auto3" class="side" style="display:none">Auto: Off</button>
		<br>
		<p class="side" id="tree4Display">Willow Trees: 0</p>
		<button type="button" onclick="buyTree(4)" id="tree4" class="side">Buy Willow Tree, cost: 1.000e7</button>
		<button type="button" onclick="auto(4)" id="auto4" class="side" style="display:none">Auto: Off</button>
		<br>
		<p class="side" id="tree5Display">Poplar Trees: 0</p>
		<button type="button" onclick="buyTree(5)" id="tree5" class="side">Buy Poplar Tree, cost: 1.000e9</button>
		<button type="button" onclick="auto(5)" id="auto5" class="side" style="display:none">Auto: Off</button>
		<br>
		<p class="side" id="tree6Display">Elm Trees: 0</p>
		<button type="button" onclick="buyTree(6)" id="tree6" class="side">Buy Elm Tree, cost: 1.000e11</button>
		<button type="button" onclick="auto(6)" id="auto6" class="side" style="display:none">Auto: Off</button>
		<br>
		<p class="side" id="tree7Display" style="display:none">Acacia Trees: 0</p>
		<button type="button" onclick="buyTree(7)" id="tree7" class="side" style="display:none">Buy Acacia Tree, cost: 1.000e16</button>
		<button type="button" onclick="auto(7)" id="auto7" class="side" style="display:none">Auto: Off</button>
		<br><br>
		<button type="button" onclick="cutTrees()" id="cut" class="side">Cut all trees to enrich the soil by 1.000</button>
		<br>
		<button type="button" onclick="prestige()" id="prestige" class="side" style="display:none">Prestige, needs at least 1 elm tree(s), buffs later trees but removes all trees and enriched soil</button>
	</div>
	<div id="tab2" style="display:none">
		<h3 id="wlogs" style="font-size:18px;">You have 10 wlogs.</h3>
		<br><br>
		<button type="button" onclick="buyWlog(1)" id="wlog1" class="side">Unlock acacia trees(boosts earlier trees)<br>Cost: 1000 wlogs</button>
	</div>
</body>
<script src="https://cdn.jsdelivr.net/npm/break_infinity.js"></script>
<script>
    /*
        For the above, note that the class "side" should be in all buttons/text in the same row,
        then put a <br> afterwards. Also, the id="thing" is how you would be able to reference things.
        You use document.getElementById("ID_HERE").innerHTML = "NEW_TEXT" to change the text.
        <p> is text, <button> is button. Remember to close them with </p> and </button>.
        When it has style="display: none;" it means it's hidden, use
        document.getElementById("ID_HERE").style.display = ""; for showing and
        document.getElementById("ID_HERE").style.display = "none"; for hiding
    */

    //Basic setup
    let logs = new Decimal(10);
    let baseTrees = [new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0)];
    let treeNames = ["Maple", "Oak", "Palm", "Willow", "Poplar", "Elm", "Acacia"];
    let cutMultiplier = new Decimal(1);
    let prestigeBuff = new Decimal(10);
    let currentAuto = 0;
    let lastTick = Date.now();
    let thisTick = 0;
	let currentTab = 1;
	let wlogs = new Decimal(0);
	let wlogPrices = [new Decimal(1000)];
	let wlogTexts = ["Unlock acacia trees(boosts earlier trees)"];
    setInterval(updateManage, 50);
    //Power is Math.pow(base,exponent) so Math.pow(2,3)=8
    
    function updateManage() {
    	thisTick = Date.now();
		for (let i = 0; i < Math.round(Math.max(0,thisTick-lastTick)/50); i++) {
			update();
		}
		lastTick = thisTick;
    }
	
    function update() {
        for (let i = 0; i < 6; i++) {
            logs = logs.add(
                baseTrees[i].times(Decimal.pow(prestigeBuff, i)).times(cutMultiplier)
            );
			baseTrees[i] = baseTrees[i].add(
				baseTrees[6].times(cutMultiplier).floor()
			);
        }
		logs = logs
		if (currentAuto != 0) {
			buyTree(currentAuto);
		}
        document.getElementById("logs").innerHTML = `You have ${make_string(logs)} logs.`;
        document.getElementById("cut").innerHTML = `Cut all trees to enrich the soil by ${getCutMultiplier().toString()}`;
        for (let j = 0; j < 7; j++) {
            document.getElementById(`tree${(j+1).toString()}Display`).innerHTML = `${treeNames[j]} Trees: ${make_string(baseTrees[j])}`;
            document.getElementById(`tree${(j+1).toString()}`).innerHTML = `Buy ${treeNames[j]} Tree, cost: ${make_string(getTreeCost(j+1))}`;
        }
        document.getElementById("wlogs").innerHTML = `You have ${make_string(wlogs)} wlogs.`;
		if (prestigeBuff.greaterThanOrEqualTo(60)) {
			document.getElementById("prestige").innerHTML = `Prestige for ${baseTrees[5]} wlogs`;
		}
    }

	function buyWlog(upgradeNum) {
		if (wlogs.greaterThanOrEqualTo(wlogPrices[upgradeNum-1])) {
			wlogs -= wlogPrices[upgradeNum-1]
			document.getElementById(`wlog${upgradeNum.toString()}`).innerHTML = wlogTexts[upgradeNum-1] + "<br>Bought!"
			document.getElementById("tree7Display").style.display = "";
			document.getElementById("tree7").style.display = "";
			document.getElementById("auto7").style.display = "";
		}
	}

    function getCutMultiplier() {
        return (new Decimal(Decimal.log10(logs)).minus(5).dividedBy(cutMultiplier).times(1000).floor().dividedBy(1000)).max(1);
    }

    function auto(treeNum) {
    	if (prestigeBuff.greaterThan(10)) {
			if (currentAuto != treeNum) {
				if (currentAuto != 0) {
					document.getElementById(`tree${currentAuto.toString()}`).disabled = false;
					document.getElementById(`auto${currentAuto.toString()}`).innerHTML = "Auto: Off";
				}
				currentAuto = treeNum;
				document.getElementById(`tree${currentAuto.toString()}`).disabled = true;
				document.getElementById(`auto${treeNum.toString()}`).innerHTML = "Auto: On";
			} else {
				document.getElementById(`tree${currentAuto.toString()}`).disabled = false;
				document.getElementById(`auto${currentAuto.toString()}`).innerHTML = "Auto: Off";
				currentAuto = 0;
			}
		} else {
			alert("You need to have prestiged at least once to use this.");
		}
    }
	
    function cutTrees() {
		if (getCutMultiplier().greaterThan(1)) {
			if (confirm("Are you sure you would like to cut down the trees for a boost?")) {
				cutMultiplier = new Decimal(Decimal.log10(logs)).minus(5).times(1000).floor().dividedBy(1000);
				baseTrees = [new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0)];
				logs = new Decimal(10);
				if (prestigeBuff.greaterThanOrEqualTo(60)) {
					document.getElementById("prestige").innerHTML = `Prestige for 0 wlogs`;
				}
            }
		}
    }
	
    function prestige() {
		if (prestigeBuff.greaterThanOrEqualTo(60)) {
			if (baseTrees[5].greaterThanOrEqualTo(1)) {
				if (confirm("Are you sure you would like to reset all previous stats for wlogs?")) {
					wlogs = wlogs.add(baseTrees[5]);
					cutMultiplier = new Decimal(1);
					baseTrees = [new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0)];
					logs = new Decimal(10);
					document.getElementById("prestige").innerHTML = `Prestige for 0 wlogs`;
				}
			}
        } else if (baseTrees[5].greaterThanOrEqualTo(prestigeBuff.dividedBy(5).minus(1))) {
			if (confirm("Are you sure you would like to reset all previous stats for a prestige?")) {
				cutMultiplier = new Decimal(1);
				baseTrees = [new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0)];
				logs = new Decimal(10);
				prestigeBuff = prestigeBuff.plus(5);
				document.getElementById("prestige").innerHTML = `Prestige, needs at least ${prestigeBuff.dividedBy(5).minus(1)} elm tree(s), buffs later trees but removes all trees and enriched soil`;
				if (prestigeBuff.greaterThanOrEqualTo(60)) {
					document.getElementById("tabButton2").style.display = "";
					document.getElementById("prestige").innerHTML = `Prestige for 0 wlogs`;
					wlogs = new Decimal(10);
				}
				for (let i = 1; i <= 6; i++) {
					document.getElementById(`auto${i.toString()}`).style.display = "";
				}
			}
        }
    }

    function getTreeCost(treeNum) {
		if (treeNum == 7) {
			return Decimal.pow(10, baseTrees[6].add(16));
		}
        return Decimal.pow(100, treeNum - 1).times(10).add(baseTrees[treeNum - 1]);
    }

    function buyTree(treeNum) {
        if (logs.greaterThanOrEqualTo(getTreeCost(treeNum))) {
            logs = logs.minus(getTreeCost(treeNum));
            baseTrees[treeNum - 1] = baseTrees[treeNum - 1].add(1);
            document.getElementById(`tree${treeNum.toString()}`).innerHTML = `Buy ${treeNames[treeNum-1]} Tree, cost: ${make_string(getTreeCost(treeNum))}`;
			if (treeNum == 6) {
				document.getElementById("prestige").style.display = "";
				if (prestigeBuff.greaterThanOrEqualTo(60)) {
					document.getElementById("prestige").innerHTML = `Prestige for ${baseTrees[5]} wlogs`;
				}
			}
        }
    }

    function buyMax(treeNum) {
        /*this function doesn't take the cost increase into account lol, fix this
      if(logs.greaterThanOrEqualTo(getTreeCost(treeNum))) {
		let numBought = logs.dividedBy(getTreeCost(treeNum)).floor();
        baseTrees[treeNum-1] = baseTrees[treeNum-1].add(numBought);
        logs = logs.minus(getTreeCost(treeNum).times(numBought));
		document.getElementById(`tree${treeNum.toString()}`).innerHTML = `Buy ${treeNames[treeNum-1]} Tree, cost: ${make_string(getTreeCost(treeNum))}`;
      }
	  */
        alert("Buy max doesn't work yet, spam jatloe to fix it");
    }

    //This function turns numbers into nice numbers(make_string(1234567)=1.234e6)
    function make_string(number) {
        if (number < 1000000) {
            return number.toFixed(3);
        } else if (isNaN(number)) {
            return "NaN";
        } else {
            let power = Math.floor(Math.log10(number));
            number = number / Math.pow(10, power);
            return number.toFixed(3) + "e" + String(power);
        }
    }

    //Log function because I can't find it anywhere
    function log(a, b) {
        return Math.round(Math.log(b) / Math.log(a));
    }

	function openTab(tab) {
	  document.getElementById("tab" + String(currentTab)).style.display = "none";
	  document.getElementById("tab" + String(tab)).style.display = "";
	  currentTab = tab;
    }

	function debug_to_part(part) {
		if (part == "wlog") {
			if (confirm("THIS FUNCTION IS ONLY FOR DEBUGGING PURPOSES. Using this function for other purposes can ruin a part of the game, and you are strongly advised to click cancel. If you have any questions, feel free to ask jatloe12345#8718 on Discord. With all that said, would you like to skip to the wlog part of the game?")) {
				prestigeBuff = new Decimal(60);
				baseTrees[5] = new Decimal(1000);
				document.getElementById("tabButton2").style.display = "";
				document.getElementById("prestige").style.display = "";
				document.getElementById("prestige").innerHTML = `Prestige for 0 wlogs`;
				wlogs = new Decimal(10);
				for (let i = 1; i <= 6; i++) {
					document.getElementById(`auto${i.toString()}`).style.display = "";
				}
				prestige();
			}
		}
	}

    //Hotkeys, keycodes are here https://www.toptal.com/developers/keycode
    document.onkeyup = function(e) {
        if (e.which == 49 || e.which == 97) {
            buyTree(1);
        } else if (e.which == 50 || e.which == 98) {
            buyTree(2);
        } else if (e.which == 51 || e.which == 99) {
            buyTree(3);
        } else if (e.which == 52 || e.which == 100) {
            buyTree(4);
        } else if (e.which == 53 || e.which == 101) {
            buyTree(5);
        } else if (e.which == 54 || e.which == 102) {
            buyTree(6);
        } else if (e.which == 67) {
            cutTrees();
        } else if (e.which == 80) {
            prestige();
        }
    };
</script>

</html>
