<!DOCTYPE html>
<html>

<head>
    <link rel="icon" href="jatloesmile-hd.png">
    <title>Log Idle</title>
    <style>
        .side {
            display: inline;
        }

        body {
            font-family: 'Monospace Typewriter', monospace;
            font-size: 15px;
        }
    </style>
</head>

<body>
    <p>V1.22</p>
    <h3 id="logs" style="font-size:18px;">You have 10 logs.</h3>
    <br><br>
    <p class="side" id="tree1Display">Maple Trees: 0</p>
    <button type="button" onclick="buyTree(1)" id="tree1" class="side">Buy Maple Tree, cost: 10.000</button>
    <button type="button" onclick="auto(1)" id="auto1" class="side">Auto: Off</button>
    <br>
    <p class="side" id="tree2Display">Oak Trees: 0</p>
    <button type="button" onclick="buyTree(2)" id="tree2" class="side">Buy Oak Tree, cost: 1000.000</button>
    <button type="button" onclick="auto(2)" id="auto2" class="side">Auto: Off</button>
    <br>
    <p class="side" id="tree3Display">Palm Trees: 0</p>
    <button type="button" onclick="buyTree(3)" id="tree3" class="side">Buy Palm Tree, cost: 100000.000</button>
    <button type="button" onclick="auto(3)" id="auto3" class="side">Auto: Off</button>
    <br>
    <p class="side" id="tree4Display">Willow Trees: 0</p>
    <button type="button" onclick="buyTree(4)" id="tree4" class="side">Buy Willow Tree, cost: 1.000e7</button>
    <button type="button" onclick="auto(4)" id="auto4" class="side">Auto: Off</button>
    <br>
    <p class="side" id="tree5Display">Poplar Trees: 0</p>
    <button type="button" onclick="buyTree(5)" id="tree5" class="side">Buy Poplar Tree, cost: 1.000e9</button>
    <button type="button" onclick="auto(5)" id="auto5" class="side">Auto: Off</button>
    <br>
    <p class="side" id="tree6Display">Elm Trees: 0</p>
    <button type="button" onclick="buyTree(6)" id="tree6" class="side">Buy Elm Tree, cost: 1.000e11</button>
    <button type="button" onclick="auto(6)" id="auto6" class="side">Auto: Off</button>
    <br><br>
    <button type="button" onclick="cutTrees()" id="cut" class="side">Cut all trees to enrich the soil by 1.000</button>
    <br>
    <button type="button" onclick="prestige()" id="prestige" class="side">Prestige, needs at least 1 elm tree(s), buffs later trees but removes all trees and enriched soil</button>
</body>
<script src="https://cdn.jsdelivr.net/npm/break_infinity.js"></script>
<script>
    /*
        For the above, note that the class "side" should be in all buttons/text in the same row,
        then put a <br> afterwards. Also, the id="thing" is how you would be able to reference things.
        You use document.getElementById("ID_HERE").innerHTML = "NEW_TEXT" to change the text.
        <p> is text, <button> is button. Remember to close them with </p> and </button>.
        When it has style="display: none;" it means it's hidden, use
        document.getElementById("ID_HERE").style.display = ""; for showing and
        document.getElementById("ID_HERE").style.display = "none"; for hiding
    */

    //Basic setup
    let logs = new Decimal(10);
    let baseTrees = [new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0)];
    let treeNames = ["Maple", "Oak", "Palm", "Willow", "Poplar", "Elm"];
    let cutMultiplier = new Decimal(1);
    let prestigeBuff = new Decimal(10);
    let currentAuto = 0;
    setInterval(update, 50);
    //Power is Math.pow(base,exponent) so Math.pow(2,3)=8

    function update() {
        for (let i = 0; i < 6; i++) {
            logs = logs.add(
                baseTrees[i].times(Decimal.pow(prestigeBuff, i)).times(cutMultiplier)
            );
        }
	if (currentAuto != 0) {
	    buyTree(currentAuto);
	}
        document.getElementById("logs").innerHTML = `You have ${make_string(logs)} logs.`;
        document.getElementById("cut").innerHTML = `Cut all trees to enrich the soil by ${getCutMultiplier().toString()}`;
        for (let j = 0; j < 6; j++) {
            document.getElementById(`tree${(j+1).toString()}Display`).innerHTML = `${treeNames[j]} Trees: ${make_string(baseTrees[j])}`;
            document.getElementById(`tree${(j+1).toString()}`).innerHTML = `Buy ${treeNames[j]} Tree, cost: ${make_string(getTreeCost(j+1))}`;
        }
    }

    function getCutMultiplier() {
        return (new Decimal(Decimal.log10(logs)).minus(5).dividedBy(cutMultiplier).times(1000).floor().dividedBy(1000)).max(1);
    }

    function auto(treeNum) {
    	if (prestigeBuff.greaterThan(10)) {
	    if (currentAuto != treeNum) {
		if (currentAuto != 0) {
		    document.getElementById(`tree${currentAuto.toString()}`).disabled = false;
		    document.getElementById(`auto${currentAuto.toString()}`).innerHTML = "Auto: Off";
		}
		currentAuto = treeNum;
		document.getElementById(`tree${currentAuto.toString()}`).disabled = true;
		document.getElementById(`auto${treeNum.toString()}`).innerHTML = "Auto: On";
	    } else {
		document.getElementById(`tree${currentAuto.toString()}`).disabled = false;
		document.getElementById(`auto${currentAuto.toString()}`).innerHTML = "Auto: Off";
		currentAuto = 0;
	    }
	} else {
	    alert("You need to have prestiged at least once to use this.");
	}
    }
	
    function cutTrees() {
	if (getCutMultiplier().greaterThan(1)) {
            if (confirm("Are you sure you would like to cut down the trees for a boost?")) {
        	cutMultiplier = new Decimal(Decimal.log10(logs)).minus(5).times(1000).floor().dividedBy(1000);
        	baseTrees = [new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0)];
        	logs = new Decimal(10);
            }
	}
    }
	
    function prestige() {
    	if (baseTrees[5].greaterThanOrEqualTo(prestigeBuff.dividedBy(5).minus(1))) {
	    if (confirm("Are you sure you would like to reset all previous stats for a prestige?")) {
		cutMultiplier = new Decimal(1);
		baseTrees = [new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0), new Decimal(0)];
		logs = new Decimal(10);
		prestigeBuff = prestigeBuff.plus(5);
		document.getElementById("prestige").innerHTML = `Prestige, needs at least ${prestigeBuff.dividedBy(5).minus(1)} elm tree(s), buffs later trees but removes all trees and enriched soil`;
	    }
        }
    }

    function getTreeCost(treeNum) {
        return Decimal.pow(100, treeNum - 1).times(10).add(baseTrees[treeNum - 1]);
    }

    function buyTree(treeNum) {
        if (logs.greaterThanOrEqualTo(getTreeCost(treeNum))) {
            baseTrees[treeNum - 1] = baseTrees[treeNum - 1].add(1);
            logs = logs.minus(getTreeCost(treeNum));
            document.getElementById(`tree${treeNum.toString()}`).innerHTML = `Buy ${treeNames[treeNum-1]} Tree, cost: ${make_string(getTreeCost(treeNum))}`;
        }
    }

    function buyMax(treeNum) {
        /*this function doesn't take the cost increase into account lol, fix this
      if(logs.greaterThanOrEqualTo(getTreeCost(treeNum))) {
		let numBought = logs.dividedBy(getTreeCost(treeNum)).floor();
        baseTrees[treeNum-1] = baseTrees[treeNum-1].add(numBought);
        logs = logs.minus(getTreeCost(treeNum).times(numBought));
		document.getElementById(`tree${treeNum.toString()}`).innerHTML = `Buy ${treeNames[treeNum-1]} Tree, cost: ${make_string(getTreeCost(treeNum))}`;
      }
	  */
        alert("Buy max doesn't work yet, spam jatloe to fix it");
    }

    //This function turns numbers into nice numbers(make_string(1234567)=1.234e6)
    function make_string(number) {
        if (number < 1000000) {
            return number.toFixed(3);
        } else if (isNaN(number)) {
            return "NaN";
        } else {
            let power = Math.floor(Math.log10(number));
            number = number / Math.pow(10, power);
            return number.toFixed(3) + "e" + String(power);
        }
    }

    //Log function because I can't find it anywhere
    function log(a, b) {
        return Math.round(Math.log(b) / Math.log(a));
    }

    //Hotkeys, keycodes are here https://www.toptal.com/developers/keycode
    document.onkeyup = function(e) {
        if (e.which == 49 || e.which == 97) {
            buyTree(1);
        } else if (e.which == 50 || e.which == 98) {
            buyTree(2);
        } else if (e.which == 51 || e.which == 99) {
            buyTree(3);
        } else if (e.which == 52 || e.which == 100) {
            buyTree(4);
        } else if (e.which == 53 || e.which == 101) {
            buyTree(5);
        } else if (e.which == 54 || e.which == 102) {
            buyTree(6);
        } else if (e.which == 67) {
            cutTrees();
        }
    };
</script>

</html>
