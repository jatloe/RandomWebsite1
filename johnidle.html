<!DOCTYPE html>
<html>
  <head>
    <link rel="icon" href="jatloesmile-hd.png">
    <style>
      .side{
        display: inline;
      }
    </style>
  </head>
  <body>
    <p class="side">V1.1.3</p>
    <button onclick="save()">Save points only</button>
    <h3 id="points">You have 1 points.</h3>
    <p class="side" id="boostDisplay">Boost: 1</p>
    <button type="button" onclick="buyBoost()" id="boost">Buy boost: 100 points</button>
    <br>
    <p class="side" id="gen1Display">Generator 1: 1</p>
    <button type="button" onclick="buyGen(1)" id="gen1">1 -> 1</button>
    <br>
    <p class="side" id="gen2Display">Generator 2: 1</p>
    <button type="button" onclick="buyGen(2)" id="gen2">1 -> 1</button>
    <br>
    <p class="side" id="gen3Display">Generator 3: 1</p>
    <button type="button" onclick="buyGen(3)" id="gen3">1 -> 1</button>
    <br>
    <p class="side" id="gen4Display">Generator 4: 1</p>
    <button type="button" onclick="buyGen(4)" id="gen4">1 -> 1</button>
    <br>
    <p class="side" id="gen5Display">Generator 5: 1</p>
    <button type="button" onclick="buyGen(5)" id="gen5">1 -> 1</button>
    <br>
    <p class="side" id="gen6Display">Generator 6 1</p>
    <button type="button" onclick="buyGen(6)" id="gen6">1 -> 1</button>
  </body>
  <script>
    let points = 1;
    if(localStorage.getItem('johnidlepoints') != null) {
      points = Number(localStorage.getItem('johnidlepoints'));
    }
    let gencount = [1,1,1,1,1,1,points];
    let boost = 1;
    let IP = 0;
    let rate = 1;
    setInterval(update,50);
    
    function update() {
      gencount[6] = points;
      rate = gencount[0]*gencount[1]*gencount[2]*gencount[3]*gencount[4]*gencount[5]*boost*Math.pow(1+IP,3);
      points = points + rate;
      document.getElementById("points").innerHTML = "You have " + stringify(points) + " points.";
      document.getElementById("boost").innerHTML = "Buy boost: " + booststring(boostCost(boost)) + " points";
      document.getElementById("boostDisplay").innerHTML = "Boost: " + String(boost);
      for(i=0;i<6;i++) {
        document.getElementById("gen" + String(i+1) + "Display").innerHTML = "Generator " + String(i+1) + ": " + stringify(gencount[i]);
        document.getElementById("gen" + String(i+1)).innerHTML = stringify(gencount[i]) + " -> " + stringify(Math.sqrt(gencount[workingIndex(i+6)]));
      }
    }
      
    function save() {
      localStorage.setItem('johnidlepoints', points);
    }
    
    function goodNumber(number) {
      return Math.round(number*1000)/1000;
    }
    
    function stringify(number) {
      number = goodNumber(number);
      if(number<1000000) {
        let stringy = String(number*1000);
        return stringy.slice(0,-3) + "." + stringy.slice(-3);
      } else {
        let power = Math.floor(Math.log10(number));
        number = Math.round(number/Math.pow(10,power-3));
        let stringy = String(number);
        return stringy.slice(0,-3) + "." + stringy.slice(-3) + "e" + String(power);
      }
    }
    
    function booststring(number) {
      if(number>1000000) {
        return "1e" + String(Math.log10(number));
      } else {
        return number;
      }
    }
    
    function log(a,b) {
      return Math.round(Math.log(b) / Math.log(a));
    }
    
    function boostCost(x) {
      return Math.pow(10,Math.pow(2,log(3,x)+1));
    }
    
    function buyBoost() {
      if(points>=boostCost(boost)) {
        points = points - boostCost(boost);
        boost = boost * 3;
        update();
      }
    }
    
    function buyGen(num) {
      if(gencount[workingIndex(num+6)] < Math.sqrt(gencount[workingIndex(num+5)])) {
        gencount[workingIndex(num+6)] = Math.sqrt(gencount[workingIndex(num+5)]);
        for(let i=-1;i<num-1;i++) {
          gencount[workingIndex(i)]=1;
        }
        points = 1;
        update();
      }
    }
    
    function workingIndex(num) {
      return (num+700)%7;
    }
  </script>
</html>
