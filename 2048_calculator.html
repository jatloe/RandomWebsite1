<!DOCTYPE html>
<html>

<head>
    <link rel="icon" href="jatloesmile-hd.png">
    <title>2048 Probability Calculator</title>
    <style>
        .side {
            display: inline;
        }
    </style>
</head>

<body>
    <p class="side">4 spawn probability:</p>
    <input type="text" id="spawnrate" size="3" maxlength="3" value="10" class="side">
    <p class="side">%</p>
    <br>
    <div id="s1p1" class="side">
        <input type="text" id="numer1" size="2" maxlength="2" value="1" class="side">
        <p class="side">/</p>
        <input type="text" id="denom1" size="2" maxlength="2" value="1" class="side">
        <select id="tile1">
            <option value="None">-</option>
            <option value="Both">Both</option>
            <option value="2">2</option>
            <option value="4">4</option>
        </select>
    </div>
    <div id="s1p2" class="side" style="display:none;">
        <p class="side">-></p>
        <input type="text" id="numer2" size="2" maxlength="2" value="1" class="side">
        <p class="side">/</p>
        <input type="text" id="denom2" size="2" maxlength="2" value="1" class="side">
        <select id="tile2">
            <option value="None">-</option>
            <option value="Both">Both</option>
            <option value="2">2</option>
            <option value="4">4</option>
        </select>
    </div>

    <div id="s1p3" class="side" style="display:none;">
        <p class="side">-></p>
        <input type="text" id="numer3" size="2" maxlength="2" value="1" class="side">
        <p class="side">/</p>
        <input type="text" id="denom3" size="2" maxlength="2" value="1" class="side">
        <select id="tile3">
            <option value="None">-</option>
            <option value="Both">Both</option>
            <option value="2">2</option>
            <option value="4">4</option>
        </select>
    </div>

    <div id="s1p4" class="side" style="display:none;">
        <p class="side">-></p>
        <input type="text" id="numer4" size="2" maxlength="2" value="1" class="side">
        <p class="side">/</p>
        <input type="text" id="denom4" size="2" maxlength="2" value="1" class="side">
        <select id="tile4">
            <option value="None">-</option>
            <option value="Both">Both</option>
            <option value="2">2</option>
            <option value="4">4</option>
        </select>
    </div>
    <div id="s1p5" class="side" style="display:none;">
        <p class="side">-></p>
        <input type="text" id="numer5" size="2" maxlength="2" value="1" class="side">
        <p class="side">/</p>
        <input type="text" id="denom5" size="2" maxlength="2" value="1" class="side">
        <select id="tile5">
            <option value="None">-</option>
            <option value="Both">Both</option>
            <option value="2">2</option>
            <option value="4">4</option>
        </select>
    </div>
    <br>
    <p id="prob">Probability: 100%</p>

</body>
<script>
    setInterval(update, 50);
    for (let i = 1; i < 5; i++) {
        let input = document.getElementById("tile" + i.toString());
        input.addEventListener('click', function() {
            if (input.selectedIndex != 0) {
                document.getElementById("s1p" + (i + 1).toString()).style.display = "";
            }
        });
    }

    function update() {
        let probability = 1;
        for (let i = 1; i <= 5; i++) {
            if (document.getElementById("s1p" + i.toString()).style.display != "none") {
                probability *= parseInt(document.getElementById("numer" + i.toString()).value) / parseInt(document.getElementById("denom" + i.toString()).value) * [1, 1, 1 - parseInt(document.getElementById("spawnrate").value) / 100, parseInt(document.getElementById("spawnrate").value) / 100][document.getElementById("tile" + i.toString()).selectedIndex];
            }
        }
        document.getElementById("prob").innerHTML = "Probability: " + Math.round(probability * 100000) / 1000 + "%";
    }
</script>

</html>
